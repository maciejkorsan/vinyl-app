// html5-qrcode@2.3.8 downloaded from https://ga.jspm.io/npm:html5-qrcode@2.3.8/esm/index.js

import{_ as e,Z as t}from"../_/aee98b16.js";var n;(function(e){e[e.QR_CODE=0]="QR_CODE";e[e.AZTEC=1]="AZTEC";e[e.CODABAR=2]="CODABAR";e[e.CODE_39=3]="CODE_39";e[e.CODE_93=4]="CODE_93";e[e.CODE_128=5]="CODE_128";e[e.DATA_MATRIX=6]="DATA_MATRIX";e[e.MAXICODE=7]="MAXICODE";e[e.ITF=8]="ITF";e[e.EAN_13=9]="EAN_13";e[e.EAN_8=10]="EAN_8";e[e.PDF_417=11]="PDF_417";e[e.RSS_14=12]="RSS_14";e[e.RSS_EXPANDED=13]="RSS_EXPANDED";e[e.UPC_A=14]="UPC_A";e[e.UPC_E=15]="UPC_E";e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(n||(n={}));var r=new Map([[n.QR_CODE,"QR_CODE"],[n.AZTEC,"AZTEC"],[n.CODABAR,"CODABAR"],[n.CODE_39,"CODE_39"],[n.CODE_93,"CODE_93"],[n.CODE_128,"CODE_128"],[n.DATA_MATRIX,"DATA_MATRIX"],[n.MAXICODE,"MAXICODE"],[n.ITF,"ITF"],[n.EAN_13,"EAN_13"],[n.EAN_8,"EAN_8"],[n.PDF_417,"PDF_417"],[n.RSS_14,"RSS_14"],[n.RSS_EXPANDED,"RSS_EXPANDED"],[n.UPC_A,"UPC_A"],[n.UPC_E,"UPC_E"],[n.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]);var a;(function(e){e[e.UNKNOWN=0]="UNKNOWN";e[e.URL=1]="URL"})(a||(a={}));function isValidHtml5QrcodeSupportedFormats(e){return Object.values(n).includes(e)}var o;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA";e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(o||(o={}));var i=function(){function Html5QrcodeConstants(){}Html5QrcodeConstants.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode";Html5QrcodeConstants.SCAN_DEFAULT_FPS=2;Html5QrcodeConstants.DEFAULT_DISABLE_FLIP=false;Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED=true;Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE=[o.SCAN_TYPE_CAMERA,o.SCAN_TYPE_FILE];return Html5QrcodeConstants}();var s=function(){function QrcodeResultFormat(e,t){this.format=e;this.formatName=t}QrcodeResultFormat.prototype.toString=function(){return this.formatName};QrcodeResultFormat.create=function(e){if(!r.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new QrcodeResultFormat(e,r.get(e))};return QrcodeResultFormat}();var c=function(){function Html5QrcodeResultFactory(){}Html5QrcodeResultFactory.createFromText=function(e){var t={text:e};return{decodedText:e,result:t}};Html5QrcodeResultFactory.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}};return Html5QrcodeResultFactory}();var l;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR";e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR";e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(l||(l={}));var u=function(){function Html5QrcodeErrorFactory(){}Html5QrcodeErrorFactory.createFrom=function(e){return{errorMessage:e,type:l.UNKWOWN_ERROR}};return Html5QrcodeErrorFactory}();var d=function(){function BaseLoggger(e){this.verbose=e}BaseLoggger.prototype.log=function(e){this.verbose&&console.log(e)};BaseLoggger.prototype.warn=function(e){this.verbose&&console.warn(e)};BaseLoggger.prototype.logError=function(e,t){(this.verbose||true===t)&&console.error(e)};BaseLoggger.prototype.logErrors=function(e){if(0===e.length)throw"Logger#logError called without arguments";this.verbose&&console.error(e)};return BaseLoggger}();function isNullOrUndefined(e){return"undefined"===typeof e||null===e}function clip(e,t,n){return e>n?n:e<t?t:e}var h=function(){function Html5QrcodeStrings(){}Html5QrcodeStrings.codeParseError=function(e){return"QR code parse error, error = ".concat(e)};Html5QrcodeStrings.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)};Html5QrcodeStrings.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."};Html5QrcodeStrings.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."};Html5QrcodeStrings.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."};Html5QrcodeStrings.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."};Html5QrcodeStrings.scannerPaused=function(){return"Scanner paused"};return Html5QrcodeStrings}();var p=function(){function Html5QrcodeScannerStrings(){}Html5QrcodeScannerStrings.scanningStatus=function(){return"Scanning"};Html5QrcodeScannerStrings.idleStatus=function(){return"Idle"};Html5QrcodeScannerStrings.errorStatus=function(){return"Error"};Html5QrcodeScannerStrings.permissionStatus=function(){return"Permission"};Html5QrcodeScannerStrings.noCameraFoundErrorStatus=function(){return"No Cameras"};Html5QrcodeScannerStrings.lastMatch=function(e){return"Last Match: ".concat(e)};Html5QrcodeScannerStrings.codeScannerTitle=function(){return"Code Scanner"};Html5QrcodeScannerStrings.cameraPermissionTitle=function(){return"Request Camera Permissions"};Html5QrcodeScannerStrings.cameraPermissionRequesting=function(){return"Requesting camera permissions..."};Html5QrcodeScannerStrings.noCameraFound=function(){return"No camera found"};Html5QrcodeScannerStrings.scanButtonStopScanningText=function(){return"Stop Scanning"};Html5QrcodeScannerStrings.scanButtonStartScanningText=function(){return"Start Scanning"};Html5QrcodeScannerStrings.torchOnButton=function(){return"Switch On Torch"};Html5QrcodeScannerStrings.torchOffButton=function(){return"Switch Off Torch"};Html5QrcodeScannerStrings.torchOnFailedMessage=function(){return"Failed to turn on torch"};Html5QrcodeScannerStrings.torchOffFailedMessage=function(){return"Failed to turn off torch"};Html5QrcodeScannerStrings.scanButtonScanningStarting=function(){return"Launching Camera..."};Html5QrcodeScannerStrings.textIfCameraScanSelected=function(){return"Scan an Image File"};Html5QrcodeScannerStrings.textIfFileScanSelected=function(){return"Scan using camera directly"};Html5QrcodeScannerStrings.selectCamera=function(){return"Select Camera"};Html5QrcodeScannerStrings.fileSelectionChooseImage=function(){return"Choose Image"};Html5QrcodeScannerStrings.fileSelectionChooseAnother=function(){return"Choose Another"};Html5QrcodeScannerStrings.fileSelectionNoImageSelected=function(){return"No image choosen"};Html5QrcodeScannerStrings.anonymousCameraPrefix=function(){return"Anonymous Camera"};Html5QrcodeScannerStrings.dragAndDropMessage=function(){return"Or drop an image to scan"};Html5QrcodeScannerStrings.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"};Html5QrcodeScannerStrings.zoom=function(){return"zoom"};Html5QrcodeScannerStrings.loadingImage=function(){return"Loading image..."};Html5QrcodeScannerStrings.cameraScanAltText=function(){return"Camera based scan"};Html5QrcodeScannerStrings.fileScanAltText=function(){return"Fule based scan"};return Html5QrcodeScannerStrings}();var f=function(){function LibraryInfoStrings(){}LibraryInfoStrings.poweredBy=function(){return"Powered by "};LibraryInfoStrings.reportIssues=function(){return"Report issues"};return LibraryInfoStrings}();var g=function(){function VideoConstraintsUtil(){}VideoConstraintsUtil.isMediaStreamConstraintsValid=function(e,t){if("object"!==typeof e){var n=typeof e;t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(n,"."),true);return false}var r=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"];var a=new Set(r);var o=Object.keys(e);for(var i=0,s=o;i<s.length;i++){var c=s[i];if(a.has(c)){t.logError("".concat(c," is not supported videoConstaints."),true);return false}}return true};return VideoConstraintsUtil}();var m=function(){function ZXingHtml5QrcodeDecoder(r,a,o){this.formatMap=new Map([[n.QR_CODE,e.QR_CODE],[n.AZTEC,e.AZTEC],[n.CODABAR,e.CODABAR],[n.CODE_39,e.CODE_39],[n.CODE_93,e.CODE_93],[n.CODE_128,e.CODE_128],[n.DATA_MATRIX,e.DATA_MATRIX],[n.MAXICODE,e.MAXICODE],[n.ITF,e.ITF],[n.EAN_13,e.EAN_13],[n.EAN_8,e.EAN_8],[n.PDF_417,e.PDF_417],[n.RSS_14,e.RSS_14],[n.RSS_EXPANDED,e.RSS_EXPANDED],[n.UPC_A,e.UPC_A],[n.UPC_E,e.UPC_E],[n.UPC_EAN_EXTENSION,e.UPC_EAN_EXTENSION]]);this.reverseFormatMap=this.createReverseFormatMap();if(!t)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=a;this.logger=o;var i=this.createZXingFormats(r);var s=new Map;s.set(e.POSSIBLE_FORMATS,i);s.set(e.TRY_HARDER,false);this.hints=s}ZXingHtml5QrcodeDecoder.prototype.decodeAsync=function(e){var t=this;return new Promise((function(n,r){try{n(t.decode(e))}catch(e){r(e)}}))};ZXingHtml5QrcodeDecoder.prototype.decode=function(t){var n=new e(this.verbose,this.hints);var r=new e(t);var a=new e(new e(r));var o=n.decode(a);return{text:o.text,format:s.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}};ZXingHtml5QrcodeDecoder.prototype.createReverseFormatMap=function(){var e=new Map;this.formatMap.forEach((function(t,n,r){e.set(t,n)}));return e};ZXingHtml5QrcodeDecoder.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)};ZXingHtml5QrcodeDecoder.prototype.createZXingFormats=function(e){var t=[];for(var n=0,r=e;n<r.length;n++){var a=r[n];this.formatMap.has(a)?t.push(this.formatMap.get(a)):this.logger.logError("".concat(a," is not supported by")+"ZXingHtml5QrcodeShim")}return t};ZXingHtml5QrcodeDecoder.prototype.createDebugData=function(){return{decoderName:"zxing-js"}};return ZXingHtml5QrcodeDecoder}();var S=(void 0,function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function fulfilled(e){try{step(r.next(e))}catch(e){a(e)}}function rejected(e){try{step(r.throw(e))}catch(e){a(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))});var y=(void 0,function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(s){if(n)throw new TypeError("Generator is already executing.");while(o&&(o=0,s[0]&&(i=0)),i)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;(r=0,a)&&(s=[2&s[0],a.value]);switch(s[0]){case 0:case 1:a=s;break;case 4:i.label++;return{value:s[1],done:false};case 5:i.label++;r=s[1];s=[0];continue;case 7:s=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1];a=s;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(s);break}a[2]&&i.ops.pop();i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e];r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:true}}});var C=function(){function BarcodeDetectorDelegate(e,t,r){this.formatMap=new Map([[n.QR_CODE,"qr_code"],[n.AZTEC,"aztec"],[n.CODABAR,"codabar"],[n.CODE_39,"code_39"],[n.CODE_93,"code_93"],[n.CODE_128,"code_128"],[n.DATA_MATRIX,"data_matrix"],[n.ITF,"itf"],[n.EAN_13,"ean_13"],[n.EAN_8,"ean_8"],[n.PDF_417,"pdf417"],[n.UPC_A,"upc_a"],[n.UPC_E,"upc_e"]]);this.reverseFormatMap=this.createReverseFormatMap();if(!BarcodeDetectorDelegate.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t;this.logger=r;var a=this.createBarcodeDetectorFormats(e);this.detector=new BarcodeDetector(a);if(!this.detector)throw"BarcodeDetector detector not supported"}BarcodeDetectorDelegate.isSupported=function(){if(!("BarcodeDetector"in window))return false;var e=new BarcodeDetector({formats:["qr_code"]});return"undefined"!==typeof e};BarcodeDetectorDelegate.prototype.decodeAsync=function(e){return S(this,void 0,void 0,(function(){var t,n;return y(this,(function(r){switch(r.label){case 0:return[4,this.detector.detect(e)];case 1:t=r.sent();if(!t||0===t.length)throw"No barcode or QR code detected.";n=this.selectLargestBarcode(t);return[2,{text:n.rawValue,format:s.create(this.toHtml5QrcodeSupportedFormats(n.format)),debugData:this.createDebugData()}]}}))}))};BarcodeDetectorDelegate.prototype.selectLargestBarcode=function(e){var t=null;var n=0;for(var r=0,a=e;r<a.length;r++){var o=a[r];var i=o.boundingBox.width*o.boundingBox.height;if(i>n){n=i;t=o}}if(!t)throw"No largest barcode found";return t};BarcodeDetectorDelegate.prototype.createBarcodeDetectorFormats=function(e){var t=[];for(var n=0,r=e;n<r.length;n++){var a=r[n];this.formatMap.has(a)?t.push(this.formatMap.get(a)):this.logger.warn("".concat(a," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}};BarcodeDetectorDelegate.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)};BarcodeDetectorDelegate.prototype.createReverseFormatMap=function(){var e=new Map;this.formatMap.forEach((function(t,n,r){e.set(t,n)}));return e};BarcodeDetectorDelegate.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}};return BarcodeDetectorDelegate}();var v=(void 0,function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function fulfilled(e){try{step(r.next(e))}catch(e){a(e)}}function rejected(e){try{step(r.throw(e))}catch(e){a(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))});var T=(void 0,function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(s){if(n)throw new TypeError("Generator is already executing.");while(o&&(o=0,s[0]&&(i=0)),i)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;(r=0,a)&&(s=[2&s[0],a.value]);switch(s[0]){case 0:case 1:a=s;break;case 4:i.label++;return{value:s[1],done:false};case 5:i.label++;r=s[1];s=[0];continue;case 7:s=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1];a=s;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(s);break}a[2]&&i.ops.pop();i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e];r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:true}}});var M=function(){function Html5QrcodeShim(e,t,n,r){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100;this.executions=0;this.executionResults=[];this.wasPrimaryDecoderUsedInLastDecode=false;this.verbose=n;if(t&&C.isSupported()){this.primaryDecoder=new C(e,n,r);this.secondaryDecoder=new m(e,n,r)}else this.primaryDecoder=new m(e,n,r)}Html5QrcodeShim.prototype.decodeAsync=function(e){return v(this,void 0,void 0,(function(){var t;return T(this,(function(n){switch(n.label){case 0:t=performance.now();n.label=1;case 1:n.trys.push([1,,3,4]);return[4,this.getDecoder().decodeAsync(e)];case 2:return[2,n.sent()];case 3:this.possiblyLogPerformance(t);return[7];case 4:return[2]}}))}))};Html5QrcodeShim.prototype.decodeRobustlyAsync=function(e){return v(this,void 0,void 0,(function(){var t,n;return T(this,(function(r){switch(r.label){case 0:t=performance.now();r.label=1;case 1:r.trys.push([1,3,4,5]);return[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,r.sent()];case 3:n=r.sent();if(this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw n;case 4:this.possiblyLogPerformance(t);return[7];case 5:return[2]}}))}))};Html5QrcodeShim.prototype.getDecoder=function(){if(!this.secondaryDecoder)return this.primaryDecoder;if(false===this.wasPrimaryDecoderUsedInLastDecode){this.wasPrimaryDecoderUsedInLastDecode=true;return this.primaryDecoder}this.wasPrimaryDecoderUsedInLastDecode=false;return this.secondaryDecoder};Html5QrcodeShim.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t);this.executions++;this.possiblyFlushPerformanceReport()}};Html5QrcodeShim.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){var e=0;for(var t=0,n=this.executionResults;t<n.length;t++){var r=n[t];e+=r}var a=e/this.executionResults.length;console.log("".concat(a," ms for ").concat(this.executionResults.length," last runs."));this.executions=0;this.executionResults=[]}};return Html5QrcodeShim}();var I=(void 0,function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};return extendStatics(e,t)};return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}());var E=(void 0,function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function fulfilled(e){try{step(r.next(e))}catch(e){a(e)}}function rejected(e){try{step(r.throw(e))}catch(e){a(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))});var A=(void 0,function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(s){if(n)throw new TypeError("Generator is already executing.");while(o&&(o=0,s[0]&&(i=0)),i)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;(r=0,a)&&(s=[2&s[0],a.value]);switch(s[0]){case 0:case 1:a=s;break;case 4:i.label++;return{value:s[1],done:false};case 5:i.label++;r=s[1];s=[0];continue;case 7:s=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1];a=s;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(s);break}a[2]&&i.ops.pop();i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e];r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:true}}});var D=function(){function AbstractCameraCapability(e,t){this.name=e;this.track=t}AbstractCameraCapability.prototype.isSupported=function(){return!!this.track.getCapabilities&&this.name in this.track.getCapabilities()};AbstractCameraCapability.prototype.apply=function(e){var t={};t[this.name]=e;var n={advanced:[t]};return this.track.applyConstraints(n)};AbstractCameraCapability.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var t=e[this.name];return t}return null};return AbstractCameraCapability}();var b=function(e){I(AbstractRangeCameraCapability,e);function AbstractRangeCameraCapability(t,n){return e.call(this,t,n)||this}AbstractRangeCameraCapability.prototype.min=function(){return this.getCapabilities().min};AbstractRangeCameraCapability.prototype.max=function(){return this.getCapabilities().max};AbstractRangeCameraCapability.prototype.step=function(){return this.getCapabilities().step};AbstractRangeCameraCapability.prototype.apply=function(e){var t={};t[this.name]=e;var n={advanced:[t]};return this.track.applyConstraints(n)};AbstractRangeCameraCapability.prototype.getCapabilities=function(){this.failIfNotSupported();var e=this.track.getCapabilities();var t=e[this.name];return{min:t.min,max:t.max,step:t.step}};AbstractRangeCameraCapability.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))};return AbstractRangeCameraCapability}(D);var N=function(e){I(ZoomFeatureImpl,e);function ZoomFeatureImpl(t){return e.call(this,"zoom",t)||this}return ZoomFeatureImpl}(b);var w=function(e){I(TorchFeatureImpl,e);function TorchFeatureImpl(t){return e.call(this,"torch",t)||this}return TorchFeatureImpl}(D);var L=function(){function CameraCapabilitiesImpl(e){this.track=e}CameraCapabilitiesImpl.prototype.zoomFeature=function(){return new N(this.track)};CameraCapabilitiesImpl.prototype.torchFeature=function(){return new w(this.track)};return CameraCapabilitiesImpl}();var O=function(){function RenderedCameraImpl(e,t,n){this.isClosed=false;this.parentElement=e;this.mediaStream=t;this.callbacks=n;this.surface=this.createVideoElement(this.parentElement.clientWidth);e.append(this.surface)}RenderedCameraImpl.prototype.createVideoElement=function(e){var t=document.createElement("video");t.style.width="".concat(e,"px");t.style.display="block";t.muted=true;t.setAttribute("muted","true");t.playsInline=true;return t};RenderedCameraImpl.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"};this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var onVideoStart=function(){var t=e.surface.clientWidth;var n=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(t,n);e.surface.removeEventListener("playing",onVideoStart)};this.surface.addEventListener("playing",onVideoStart);this.surface.srcObject=this.mediaStream;this.surface.play()};RenderedCameraImpl.create=function(e,t,n,r){return E(this,void 0,void 0,(function(){var a,o;return A(this,(function(i){switch(i.label){case 0:a=new RenderedCameraImpl(e,t,r);if(!n.aspectRatio)return[3,2];o={aspectRatio:n.aspectRatio};return[4,a.getFirstTrackOrFail().applyConstraints(o)];case 1:i.sent();i.label=2;case 2:a.setupSurface();return[2,a]}}))}))};RenderedCameraImpl.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."};RenderedCameraImpl.prototype.getFirstTrackOrFail=function(){this.failIfClosed();if(0===this.mediaStream.getVideoTracks().length)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]};RenderedCameraImpl.prototype.pause=function(){this.failIfClosed();this.surface.pause()};RenderedCameraImpl.prototype.resume=function(e){this.failIfClosed();var t=this;var onVideoResume=function(){setTimeout(e,200);t.surface.removeEventListener("playing",onVideoResume)};this.surface.addEventListener("playing",onVideoResume);this.surface.play()};RenderedCameraImpl.prototype.isPaused=function(){this.failIfClosed();return this.surface.paused};RenderedCameraImpl.prototype.getSurface=function(){this.failIfClosed();return this.surface};RenderedCameraImpl.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()};RenderedCameraImpl.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()};RenderedCameraImpl.prototype.applyVideoConstraints=function(e){return E(this,void 0,void 0,(function(){return A(this,(function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]}))}))};RenderedCameraImpl.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise((function(t,n){var r=e.mediaStream.getVideoTracks();var a=r.length;var o=0;e.mediaStream.getVideoTracks().forEach((function(n){e.mediaStream.removeTrack(n);n.stop();++o;if(o>=a){e.isClosed=true;e.parentElement.removeChild(e.surface);t()}}))}))};RenderedCameraImpl.prototype.getCapabilities=function(){return new L(this.getFirstTrackOrFail())};return RenderedCameraImpl}();var _=function(){function CameraImpl(e){this.mediaStream=e}CameraImpl.prototype.render=function(e,t,n){return E(this,void 0,void 0,(function(){return A(this,(function(r){return[2,O.create(e,this.mediaStream,t,n)]}))}))};CameraImpl.create=function(e){return E(this,void 0,void 0,(function(){var t,n;return A(this,(function(r){switch(r.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";t={audio:false,video:e};return[4,navigator.mediaDevices.getUserMedia(t)];case 1:n=r.sent();return[2,new CameraImpl(n)]}}))}))};return CameraImpl}();var x=(void 0,function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function fulfilled(e){try{step(r.next(e))}catch(e){a(e)}}function rejected(e){try{step(r.throw(e))}catch(e){a(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))});var U=(void 0,function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(s){if(n)throw new TypeError("Generator is already executing.");while(o&&(o=0,s[0]&&(i=0)),i)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;(r=0,a)&&(s=[2&s[0],a.value]);switch(s[0]){case 0:case 1:a=s;break;case 4:i.label++;return{value:s[1],done:false};case 5:i.label++;r=s[1];s=[0];continue;case 7:s=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1];a=s;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(s);break}a[2]&&i.ops.pop();i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e];r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:true}}});var R=function(){function CameraFactory(){}CameraFactory.failIfNotSupported=function(){return x(this,void 0,void 0,(function(){return U(this,(function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new CameraFactory]}))}))};CameraFactory.prototype.create=function(e){return x(this,void 0,void 0,(function(){return U(this,(function(t){return[2,_.create(e)]}))}))};return CameraFactory}();var j=(void 0,function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function fulfilled(e){try{step(r.next(e))}catch(e){a(e)}}function rejected(e){try{step(r.throw(e))}catch(e){a(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))});var Q=(void 0,function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(s){if(n)throw new TypeError("Generator is already executing.");while(o&&(o=0,s[0]&&(i=0)),i)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;(r=0,a)&&(s=[2&s[0],a.value]);switch(s[0]){case 0:case 1:a=s;break;case 4:i.label++;return{value:s[1],done:false};case 5:i.label++;r=s[1];s=[0];continue;case 7:s=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1];a=s;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(s);break}a[2]&&i.ops.pop();i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e];r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:true}}});var H=function(){function CameraRetriever(){}CameraRetriever.retrieve=function(){if(navigator.mediaDevices)return CameraRetriever.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?CameraRetriever.getCamerasFromMediaStreamTrack():CameraRetriever.rejectWithError()};CameraRetriever.rejectWithError=function(){var e=h.unableToQuerySupportedDevices();CameraRetriever.isHttpsOrLocalhost()||(e=h.insecureContextCameraQueryError());return Promise.reject(e)};CameraRetriever.isHttpsOrLocalhost=function(){if("https:"===location.protocol)return true;var e=location.host.split(":")[0];return"127.0.0.1"===e||"localhost"===e};CameraRetriever.getCamerasFromMediaDevices=function(){return j(this,void 0,void 0,(function(){var e,t,n,r,a,o,i;return Q(this,(function(s){switch(s.label){case 0:e=function(e){var t=e.getVideoTracks();for(var n=0,r=t;n<r.length;n++){var a=r[n];a.enabled=false;a.stop();e.removeTrack(a)}};return[4,navigator.mediaDevices.getUserMedia({audio:false,video:true})];case 1:t=s.sent();return[4,navigator.mediaDevices.enumerateDevices()];case 2:n=s.sent();r=[];for(a=0,o=n;a<o.length;a++){i=o[a];"videoinput"===i.kind&&r.push({id:i.deviceId,label:i.label})}e(t);return[2,r]}}))}))};CameraRetriever.getCamerasFromMediaStreamTrack=function(){return new Promise((function(e,t){var callback=function(t){var n=[];for(var r=0,a=t;r<a.length;r++){var o=a[r];"video"===o.kind&&n.push({id:o.id,label:o.label})}e(n)};var n=MediaStreamTrack;n.getSources(callback)}))};return CameraRetriever}();var F;(function(e){e[e.UNKNOWN=0]="UNKNOWN";e[e.NOT_STARTED=1]="NOT_STARTED";e[e.SCANNING=2]="SCANNING";e[e.PAUSED=3]="PAUSED"})(F||(F={}));var P=function(){function StateManagerImpl(){this.state=F.NOT_STARTED;this.onGoingTransactionNewState=F.UNKNOWN}StateManagerImpl.prototype.directTransition=function(e){this.failIfTransitionOngoing();this.validateTransition(e);this.state=e};StateManagerImpl.prototype.startTransition=function(e){this.failIfTransitionOngoing();this.validateTransition(e);this.onGoingTransactionNewState=e;return this};StateManagerImpl.prototype.execute=function(){if(this.onGoingTransactionNewState===F.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=F.UNKNOWN;this.directTransition(e)};StateManagerImpl.prototype.cancel=function(){if(this.onGoingTransactionNewState===F.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=F.UNKNOWN};StateManagerImpl.prototype.getState=function(){return this.state};StateManagerImpl.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==F.UNKNOWN)throw"Cannot transition to a new state, already under transition"};StateManagerImpl.prototype.validateTransition=function(e){switch(this.state){case F.UNKNOWN:throw"Transition from unknown is not allowed";case F.NOT_STARTED:this.failIfNewStateIs(e,[F.PAUSED]);break;case F.SCANNING:break;case F.PAUSED:break}};StateManagerImpl.prototype.failIfNewStateIs=function(e,t){for(var n=0,r=t;n<r.length;n++){var a=r[n];if(e===a)throw"Cannot transition from ".concat(this.state," to ").concat(e)}};return StateManagerImpl}();var B=function(){function StateManagerProxy(e){this.stateManager=e}StateManagerProxy.prototype.startTransition=function(e){return this.stateManager.startTransition(e)};StateManagerProxy.prototype.directTransition=function(e){this.stateManager.directTransition(e)};StateManagerProxy.prototype.getState=function(){return this.stateManager.getState()};StateManagerProxy.prototype.canScanFile=function(){return this.stateManager.getState()===F.NOT_STARTED};StateManagerProxy.prototype.isScanning=function(){return this.stateManager.getState()!==F.NOT_STARTED};StateManagerProxy.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===F.SCANNING};StateManagerProxy.prototype.isPaused=function(){return this.stateManager.getState()===F.PAUSED};return StateManagerProxy}();var z=function(){function StateManagerFactory(){}StateManagerFactory.create=function(){return new B(new P)};return StateManagerFactory}();var k=(void 0,function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};return extendStatics(e,t)};return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}());var Y=function(e){k(Constants,e);function Constants(){return null!==e&&e.apply(this,arguments)||this}Constants.DEFAULT_WIDTH=300;Constants.DEFAULT_WIDTH_OFFSET=2;Constants.FILE_SCAN_MIN_HEIGHT=300;Constants.FILE_SCAN_HIDDEN_CANVAS_PADDING=100;Constants.MIN_QR_BOX_SIZE=50;Constants.SHADED_LEFT=1;Constants.SHADED_RIGHT=2;Constants.SHADED_TOP=3;Constants.SHADED_BOTTOM=4;Constants.SHADED_REGION_ELEMENT_ID="qr-shaded-region";Constants.VERBOSE=false;Constants.BORDER_SHADER_DEFAULT_COLOR="#ffffff";Constants.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)";return Constants}(i);var V=function(){function InternalHtml5QrcodeConfig(e,t){this.logger=t;this.fps=Y.SCAN_DEFAULT_FPS;if(e){e.fps&&(this.fps=e.fps);this.disableFlip=true===e.disableFlip;this.qrbox=e.qrbox;this.aspectRatio=e.aspectRatio;this.videoConstraints=e.videoConstraints}else this.disableFlip=Y.DEFAULT_DISABLE_FLIP}InternalHtml5QrcodeConfig.prototype.isMediaStreamConstraintsValid=function(){if(!this.videoConstraints){this.logger.logError("Empty videoConstraints",true);return false}return g.isMediaStreamConstraintsValid(this.videoConstraints,this.logger)};InternalHtml5QrcodeConfig.prototype.isShadedBoxEnabled=function(){return!isNullOrUndefined(this.qrbox)};InternalHtml5QrcodeConfig.create=function(e,t){return new InternalHtml5QrcodeConfig(e,t)};return InternalHtml5QrcodeConfig}();var Z=function(){function Html5Qrcode(e,t){this.element=null;this.canvasElement=null;this.scannerPausedUiElement=null;this.hasBorderShaders=null;this.borderShaders=null;this.qrMatch=null;this.renderedCamera=null;this.qrRegion=null;this.context=null;this.lastScanImageFile=null;this.isScanning=false;if(!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e;this.verbose=false;var n;if("boolean"==typeof t)this.verbose=true===t;else if(t){n=t;this.verbose=true===n.verbose;n.experimentalFeatures}this.logger=new d(this.verbose);this.qrcode=new M(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(n),this.verbose,this.logger);this.foreverScanTimeout;this.shouldScan=true;this.stateManagerProxy=z.create()}Html5Qrcode.prototype.start=function(e,t,n,r){var a=this;if(!e)throw"cameraIdOrConfig is required";if(!n||"function"!=typeof n)throw"qrCodeSuccessCallback is required and should be a function.";var o;o=r||(this.verbose?this.logger.log:function(){});var i=V.create(t,this.logger);this.clearElement();var s=false;i.videoConstraints&&(i.isMediaStreamConstraintsValid()?s=true:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",true));var c=s;var l=document.getElementById(this.elementId);l.clientWidth?l.clientWidth:Y.DEFAULT_WIDTH;l.style.position="relative";this.shouldScan=true;this.element=l;var u=this;var d=this.stateManagerProxy.startTransition(F.SCANNING);return new Promise((function(t,r){var s=c?i.videoConstraints:u.createVideoConstraints(e);if(s){var l={};c&&!i.aspectRatio||(l.aspectRatio=i.aspectRatio);var p={onRenderSurfaceReady:function(e,t){u.setupUi(e,t,i);u.isScanning=true;u.foreverScan(i,n,o)}};R.failIfNotSupported().then((function(e){e.create(s).then((function(e){return e.render(a.element,l,p).then((function(e){u.renderedCamera=e;d.execute();t(null)})).catch((function(e){d.cancel();r(e)}))})).catch((function(e){d.cancel();r(h.errorGettingUserMedia(e))}))})).catch((function(e){d.cancel();r(h.cameraStreamingNotSupported())}))}else{d.cancel();r("videoConstraints should be defined")}}))};Html5Qrcode.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(F.PAUSED);this.showPausedState();(isNullOrUndefined(e)||true!==e)&&(e=false);e&&this.renderedCamera&&this.renderedCamera.pause()};Html5Qrcode.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this;var transitionToScanning=function(){e.stateManagerProxy.directTransition(F.SCANNING);e.hidePausedState()};this.renderedCamera.isPaused()?this.renderedCamera.resume((function(){transitionToScanning()})):transitionToScanning()};Html5Qrcode.prototype.getState=function(){return this.stateManagerProxy.getState()};Html5Qrcode.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(F.NOT_STARTED);this.shouldScan=false;this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var removeQrRegion=function(){if(e.element){var t=document.getElementById(Y.SHADED_REGION_ELEMENT_ID);t&&e.element.removeChild(t)}};var n=this;return this.renderedCamera.close().then((function(){n.renderedCamera=null;if(n.element){n.element.removeChild(n.canvasElement);n.canvasElement=null}removeQrRegion();n.qrRegion&&(n.qrRegion=null);n.context&&(n.context=null);t.execute();n.hidePausedState();n.isScanning=false;return Promise.resolve()}))};Html5Qrcode.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then((function(e){return e.decodedText}))};Html5Qrcode.prototype.scanFileV2=function(e,t){var n=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";isNullOrUndefined(t)&&(t=true);if(!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise((function(r,a){n.possiblyCloseLastScanImageFile();n.clearElement();n.lastScanImageFile=URL.createObjectURL(e);var o=new Image;o.onload=function(){var e=o.width;var i=o.height;var s=document.getElementById(n.elementId);var l=s.clientWidth?s.clientWidth:Y.DEFAULT_WIDTH;var u=Math.max(s.clientHeight?s.clientHeight:i,Y.FILE_SCAN_MIN_HEIGHT);var d=n.computeCanvasDrawConfig(e,i,l,u);if(t){var h=n.createCanvasElement(l,u,"qr-canvas-visible");h.style.display="inline-block";s.appendChild(h);var p=h.getContext("2d");if(!p)throw"Unable to get 2d context from canvas";p.canvas.width=l;p.canvas.height=u;p.drawImage(o,0,0,e,i,d.x,d.y,d.width,d.height)}var f=Y.FILE_SCAN_HIDDEN_CANVAS_PADDING;var g=Math.max(o.width,d.width);var m=Math.max(o.height,d.height);var S=g+2*f;var y=m+2*f;var C=n.createCanvasElement(S,y);s.appendChild(C);var v=C.getContext("2d");if(!v)throw"Unable to get 2d context from canvas";v.canvas.width=S;v.canvas.height=y;v.drawImage(o,0,0,e,i,f,f,g,m);try{n.qrcode.decodeRobustlyAsync(C).then((function(e){r(c.createFromQrcodeResult(e))})).catch(a)}catch(e){a("QR code parse error, error = ".concat(e))}};o.onerror=a;o.onabort=a;o.onstalled=a;o.onsuspend=a;o.src=URL.createObjectURL(e)}))};Html5Qrcode.prototype.clear=function(){this.clearElement()};Html5Qrcode.getCameras=function(){return H.retrieve()};Html5Qrcode.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()};Html5Qrcode.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()};Html5Qrcode.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()};Html5Qrcode.prototype.applyVideoConstraints=function(e){if(!e)throw"videoConstaints is required argument.";if(!g.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details";return this.getRenderedCameraOrFail().applyVideoConstraints(e)};Html5Qrcode.prototype.getRenderedCameraOrFail=function(){if(null==this.renderedCamera)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera};Html5Qrcode.prototype.getSupportedFormats=function(e){var t=[n.QR_CODE,n.AZTEC,n.CODABAR,n.CODE_39,n.CODE_93,n.CODE_128,n.DATA_MATRIX,n.MAXICODE,n.ITF,n.EAN_13,n.EAN_8,n.PDF_417,n.RSS_14,n.RSS_EXPANDED,n.UPC_A,n.UPC_E,n.UPC_EAN_EXTENSION];if(!e||"boolean"==typeof e)return t;if(!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(0===e.formatsToSupport.length)throw"Atleast 1 formatsToSupport is needed.";var r=[];for(var a=0,o=e.formatsToSupport;a<o.length;a++){var i=o[a];isValidHtml5QrcodeSupportedFormats(i)?r.push(i):this.logger.warn("Invalid format: ".concat(i," passed in config, ignoring."))}if(0===r.length)throw"None of formatsToSupport match supported values.";return r};Html5Qrcode.prototype.getUseBarCodeDetectorIfSupported=function(e){if(isNullOrUndefined(e))return true;if(!isNullOrUndefined(e.useBarCodeDetectorIfSupported))return false!==e.useBarCodeDetectorIfSupported;if(isNullOrUndefined(e.experimentalFeatures))return true;var t=e.experimentalFeatures;return!!isNullOrUndefined(t.useBarCodeDetectorIfSupported)||false!==t.useBarCodeDetectorIfSupported};Html5Qrcode.prototype.validateQrboxSize=function(e,t,n){var r=this;var a=n.qrbox;this.validateQrboxConfig(a);var o=this.toQrdimensions(e,t,a);var validateMinSize=function(e){if(e<Y.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Y.MIN_QR_BOX_SIZE,"px.")};var correctWidthBasedOnRootElementSize=function(t){if(t>e){r.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element.");t=e}return t};validateMinSize(o.width);validateMinSize(o.height);o.width=correctWidthBasedOnRootElementSize(o.width)};Html5Qrcode.prototype.validateQrboxConfig=function(e){if("number"!==typeof e&&"function"!==typeof e&&(void 0===e.width||void 0===e.height))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."};Html5Qrcode.prototype.toQrdimensions=function(e,t,n){if("number"===typeof n)return{width:n,height:n};if("function"===typeof n)try{return n(e,t)}catch(e){throw new Error("qrbox config was passed as a function but it failed with unknown error"+e)}return n};Html5Qrcode.prototype.setupUi=function(e,t,n){n.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,n);var r=isNullOrUndefined(n.qrbox)?{width:e,height:t}:n.qrbox;this.validateQrboxConfig(r);var a=this.toQrdimensions(e,t,r);a.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var o=n.isShadedBoxEnabled()&&a.height<=t;var i={x:0,y:0,width:e,height:t};var s=o?this.getShadedRegionBounds(e,t,a):i;var c=this.createCanvasElement(s.width,s.height);var l={willReadFrequently:true};var u=c.getContext("2d",l);u.canvas.width=s.width;u.canvas.height=s.height;this.element.append(c);o&&this.possiblyInsertShadingElement(this.element,e,t,a);this.createScannerPausedUiElement(this.element);this.qrRegion=s;this.context=u;this.canvasElement=c};Html5Qrcode.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=h.scannerPaused();t.style.display="none";t.style.position="absolute";t.style.top="0px";t.style.zIndex="1";t.style.background="rgba(9, 9, 9, 0.46)";t.style.color="#FFECEC";t.style.textAlign="center";t.style.width="100%";e.appendChild(t);this.scannerPausedUiElement=t};Html5Qrcode.prototype.scanContext=function(e,t){var n=this;return this.stateManagerProxy.isPaused()?Promise.resolve(false):this.qrcode.decodeAsync(this.canvasElement).then((function(t){e(t.text,c.createFromQrcodeResult(t));n.possiblyUpdateShaders(true);return true})).catch((function(e){n.possiblyUpdateShaders(false);var r=h.codeParseError(e);t(r,u.createFrom(r));return false}))};Html5Qrcode.prototype.foreverScan=function(e,t,n){var r=this;if(this.shouldScan&&this.renderedCamera){var a=this.renderedCamera.getSurface();var o=a.videoWidth/a.clientWidth;var i=a.videoHeight/a.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var s=this.qrRegion.width*o;var c=this.qrRegion.height*i;var l=this.qrRegion.x*o;var u=this.qrRegion.y*i;this.context.drawImage(a,l,u,s,c,0,0,this.qrRegion.width,this.qrRegion.height);var triggerNextScan=function(){r.foreverScanTimeout=setTimeout((function(){r.foreverScan(e,t,n)}),r.getTimeoutFps(e.fps))};this.scanContext(t,n).then((function(a){if(a||true===e.disableFlip)triggerNextScan();else{r.context.translate(r.context.canvas.width,0);r.context.scale(-1,1);r.scanContext(t,n).finally((function(){triggerNextScan()}))}})).catch((function(e){r.logger.logError("Error happend while scanning context",e);triggerNextScan()}))}};Html5Qrcode.prototype.createVideoConstraints=function(e){if("string"==typeof e)return{deviceId:{exact:e}};if("object"==typeof e){var t="facingMode";var n="deviceId";var r={user:true,environment:true};var a="exact";var isValidFacingModeValue=function(e){if(e in r)return true;throw"config has invalid 'facingMode' value = "+"'".concat(e,"'")};var o=Object.keys(e);if(1!==o.length)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(o.length," keys");var i=Object.keys(e)[0];if(i!==t&&i!==n)throw"Only '".concat(t,"' and '").concat(n,"' ")+" are supported for 'cameraIdOrConfig'";if(i!==t){var s=e.deviceId;if("string"==typeof s)return{deviceId:s};if("object"==typeof s){if(a in s)return{deviceId:{exact:s["".concat(a)]}};throw"'deviceId' should be string or object with"+" ".concat(a," as key.")}var c=typeof s;throw"Invalid type of 'deviceId' = ".concat(c)}var l=e.facingMode;if("string"==typeof l){if(isValidFacingModeValue(l))return{facingMode:l}}else{if("object"!=typeof l){var u=typeof l;throw"Invalid type of 'facingMode' = ".concat(u)}if(!(a in l))throw"'facingMode' should be string or object with"+" ".concat(a," as key.");if(isValidFacingModeValue(l["".concat(a)]))return{facingMode:{exact:l["".concat(a)]}}}}var d=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(d)};Html5Qrcode.prototype.computeCanvasDrawConfig=function(e,t,n,r){if(e<=n&&t<=r){var a=(n-e)/2;var o=(r-t)/2;return{x:a,y:o,width:e,height:t}}var i=e;var s=t;if(e>n){t*=n/e;e=n}if(t>r){e*=r/t;t=r}this.logger.log("Image downsampled from "+"".concat(i,"X").concat(s)+" to ".concat(e,"X").concat(t,"."));return this.computeCanvasDrawConfig(e,t,n,r)};Html5Qrcode.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")};Html5Qrcode.prototype.possiblyUpdateShaders=function(e){if(this.qrMatch!==e){this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach((function(t){t.style.backgroundColor=e?Y.BORDER_SHADER_MATCH_COLOR:Y.BORDER_SHADER_DEFAULT_COLOR}));this.qrMatch=e}};Html5Qrcode.prototype.possiblyCloseLastScanImageFile=function(){if(this.lastScanImageFile){URL.revokeObjectURL(this.lastScanImageFile);this.lastScanImageFile=null}};Html5Qrcode.prototype.createCanvasElement=function(e,t,n){var r=e;var a=t;var o=document.createElement("canvas");o.style.width="".concat(r,"px");o.style.height="".concat(a,"px");o.style.display="none";o.id=isNullOrUndefined(n)?"qr-canvas":n;return o};Html5Qrcode.prototype.getShadedRegionBounds=function(e,t,n){if(n.width>e||n.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-n.width)/2,y:(t-n.height)/2,width:n.width,height:n.height}};Html5Qrcode.prototype.possiblyInsertShadingElement=function(e,t,n,r){if(!(t-r.width<1||n-r.height<1)){var a=document.createElement("div");a.style.position="absolute";var o=(t-r.width)/2;var i=(n-r.height)/2;a.style.borderLeft="".concat(o,"px solid rgba(0, 0, 0, 0.48)");a.style.borderRight="".concat(o,"px solid rgba(0, 0, 0, 0.48)");a.style.borderTop="".concat(i,"px solid rgba(0, 0, 0, 0.48)");a.style.borderBottom="".concat(i,"px solid rgba(0, 0, 0, 0.48)");a.style.boxSizing="border-box";a.style.top="0px";a.style.bottom="0px";a.style.left="0px";a.style.right="0px";a.id="".concat(Y.SHADED_REGION_ELEMENT_ID);if(t-r.width<11||n-r.height<11)this.hasBorderShaders=false;else{var s=5;var c=40;this.insertShaderBorders(a,c,s,-s,null,0,true);this.insertShaderBorders(a,c,s,-s,null,0,false);this.insertShaderBorders(a,c,s,null,-s,0,true);this.insertShaderBorders(a,c,s,null,-s,0,false);this.insertShaderBorders(a,s,c+s,-s,null,-s,true);this.insertShaderBorders(a,s,c+s,null,-s,-s,true);this.insertShaderBorders(a,s,c+s,-s,null,-s,false);this.insertShaderBorders(a,s,c+s,null,-s,-s,false);this.hasBorderShaders=true}e.append(a)}};Html5Qrcode.prototype.insertShaderBorders=function(e,t,n,r,a,o,i){var s=document.createElement("div");s.style.position="absolute";s.style.backgroundColor=Y.BORDER_SHADER_DEFAULT_COLOR;s.style.width="".concat(t,"px");s.style.height="".concat(n,"px");null!==r&&(s.style.top="".concat(r,"px"));null!==a&&(s.style.bottom="".concat(a,"px"));i?s.style.left="".concat(o,"px"):s.style.right="".concat(o,"px");this.borderShaders||(this.borderShaders=[]);this.borderShaders.push(s);e.appendChild(s)};Html5Qrcode.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"};Html5Qrcode.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"};Html5Qrcode.prototype.getTimeoutFps=function(e){return 1e3/e};return Html5Qrcode}();var q="data:image/svg+xml;base64,";var W=q+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==";var G=q+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=";var X=q+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+";var K="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=";var J=function(){function PersistedDataFactory(){}PersistedDataFactory.createDefault=function(){return{hasPermission:false,lastUsedCameraId:null}};return PersistedDataFactory}();var $=function(){function PersistedDataManager(){this.data=J.createDefault();var e=localStorage.getItem(PersistedDataManager.LOCAL_STORAGE_KEY);e?this.data=JSON.parse(e):this.reset()}PersistedDataManager.prototype.hasCameraPermissions=function(){return this.data.hasPermission};PersistedDataManager.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId};PersistedDataManager.prototype.setHasPermission=function(e){this.data.hasPermission=e;this.flush()};PersistedDataManager.prototype.setLastUsedCameraId=function(e){this.data.lastUsedCameraId=e;this.flush()};PersistedDataManager.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null;this.flush()};PersistedDataManager.prototype.reset=function(){this.data=J.createDefault();this.flush()};PersistedDataManager.prototype.flush=function(){localStorage.setItem(PersistedDataManager.LOCAL_STORAGE_KEY,JSON.stringify(this.data))};PersistedDataManager.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA";return PersistedDataManager}();var ee=function(){function LibraryInfoDiv(){this.infoDiv=document.createElement("div")}LibraryInfoDiv.prototype.renderInto=function(e){this.infoDiv.style.position="absolute";this.infoDiv.style.top="10px";this.infoDiv.style.right="10px";this.infoDiv.style.zIndex="2";this.infoDiv.style.display="none";this.infoDiv.style.padding="5pt";this.infoDiv.style.border="1px solid #171717";this.infoDiv.style.fontSize="10pt";this.infoDiv.style.background="rgb(0 0 0 / 69%)";this.infoDiv.style.borderRadius="5px";this.infoDiv.style.textAlign="center";this.infoDiv.style.fontWeight="400";this.infoDiv.style.color="white";this.infoDiv.innerText=f.poweredBy();var t=document.createElement("a");t.innerText="ScanApp";t.href="https://scanapp.org";t.target="new";t.style.color="white";this.infoDiv.appendChild(t);var n=document.createElement("br");var r=document.createElement("br");this.infoDiv.appendChild(n);this.infoDiv.appendChild(r);var a=document.createElement("a");a.innerText=f.reportIssues();a.href="https://github.com/mebjas/html5-qrcode/issues";a.target="new";a.style.color="white";this.infoDiv.appendChild(a);e.appendChild(this.infoDiv)};LibraryInfoDiv.prototype.show=function(){this.infoDiv.style.display="block"};LibraryInfoDiv.prototype.hide=function(){this.infoDiv.style.display="none"};return LibraryInfoDiv}();var te=function(){function LibraryInfoIcon(e,t){this.isShowingInfoIcon=true;this.onTapIn=e;this.onTapOut=t;this.infoIcon=document.createElement("img")}LibraryInfoIcon.prototype.renderInto=function(e){var t=this;this.infoIcon.alt="Info icon";this.infoIcon.src=X;this.infoIcon.style.position="absolute";this.infoIcon.style.top="4px";this.infoIcon.style.right="4px";this.infoIcon.style.opacity="0.6";this.infoIcon.style.cursor="pointer";this.infoIcon.style.zIndex="2";this.infoIcon.style.width="16px";this.infoIcon.style.height="16px";this.infoIcon.onmouseover=function(e){return t.onHoverIn()};this.infoIcon.onmouseout=function(e){return t.onHoverOut()};this.infoIcon.onclick=function(e){return t.onClick()};e.appendChild(this.infoIcon)};LibraryInfoIcon.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")};LibraryInfoIcon.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")};LibraryInfoIcon.prototype.onClick=function(){if(this.isShowingInfoIcon){this.isShowingInfoIcon=false;this.onTapIn();this.infoIcon.src=K;this.infoIcon.style.opacity="1"}else{this.isShowingInfoIcon=true;this.onTapOut();this.infoIcon.src=X;this.infoIcon.style.opacity="0.6"}};return LibraryInfoIcon}();var ne=function(){function LibraryInfoContainer(){var e=this;this.infoDiv=new ee;this.infoIcon=new te((function(){e.infoDiv.show()}),(function(){e.infoDiv.hide()}))}LibraryInfoContainer.prototype.renderInto=function(e){this.infoDiv.renderInto(e);this.infoIcon.renderInto(e)};return LibraryInfoContainer}();var re=(void 0,function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function fulfilled(e){try{step(r.next(e))}catch(e){a(e)}}function rejected(e){try{step(r.throw(e))}catch(e){a(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))});var ae=(void 0,function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(s){if(n)throw new TypeError("Generator is already executing.");while(o&&(o=0,s[0]&&(i=0)),i)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;(r=0,a)&&(s=[2&s[0],a.value]);switch(s[0]){case 0:case 1:a=s;break;case 4:i.label++;return{value:s[1],done:false};case 5:i.label++;r=s[1];s=[0];continue;case 7:s=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1];a=s;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(s);break}a[2]&&i.ops.pop();i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e];r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:true}}});var oe=function(){function CameraPermissions(){}CameraPermissions.hasPermissions=function(){return re(this,void 0,void 0,(function(){var e,t,n,r;return ae(this,(function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=a.sent();for(t=0,n=e;t<n.length;t++){r=n[t];if("videoinput"===r.kind&&r.label)return[2,true]}return[2,false]}}))}))};return CameraPermissions}();var ie=function(){function ScanTypeSelector(e){this.supportedScanTypes=this.validateAndReturnScanTypes(e)}ScanTypeSelector.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]};ScanTypeSelector.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1};ScanTypeSelector.prototype.isCameraScanRequired=function(){for(var e=0,t=this.supportedScanTypes;e<t.length;e++){var n=t[e];if(ScanTypeSelector.isCameraScanType(n))return true}return false};ScanTypeSelector.isCameraScanType=function(e){return e===o.SCAN_TYPE_CAMERA};ScanTypeSelector.isFileScanType=function(e){return e===o.SCAN_TYPE_FILE};ScanTypeSelector.prototype.validateAndReturnScanTypes=function(e){if(!e||0===e.length)return i.DEFAULT_SUPPORTED_SCAN_TYPE;var t=i.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(e.length>t)throw"Max ".concat(t," values expected for ")+"supportedScanTypes";for(var n=0,r=e;n<r.length;n++){var a=r[n];if(!i.DEFAULT_SUPPORTED_SCAN_TYPE.includes(a))throw"Unsupported scan type ".concat(a)}return e};return ScanTypeSelector}();var se=function(){function PublicUiElementIdAndClasses(){}PublicUiElementIdAndClasses.ALL_ELEMENT_CLASS="html5-qrcode-element";PublicUiElementIdAndClasses.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission";PublicUiElementIdAndClasses.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start";PublicUiElementIdAndClasses.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop";PublicUiElementIdAndClasses.TORCH_BUTTON_ID="html5-qrcode-button-torch";PublicUiElementIdAndClasses.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera";PublicUiElementIdAndClasses.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection";PublicUiElementIdAndClasses.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom";PublicUiElementIdAndClasses.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change";PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on";PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off";return PublicUiElementIdAndClasses}();var ce=function(){function BaseUiElementFactory(){}BaseUiElementFactory.createElement=function(e,t){var n=document.createElement(e);n.id=t;n.classList.add(se.ALL_ELEMENT_CLASS);"button"===e&&n.setAttribute("type","button");return n};return BaseUiElementFactory}();var le=(void 0,function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function fulfilled(e){try{step(r.next(e))}catch(e){a(e)}}function rejected(e){try{step(r.throw(e))}catch(e){a(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))});var ue=(void 0,function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(s){if(n)throw new TypeError("Generator is already executing.");while(o&&(o=0,s[0]&&(i=0)),i)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;(r=0,a)&&(s=[2&s[0],a.value]);switch(s[0]){case 0:case 1:a=s;break;case 4:i.label++;return{value:s[1],done:false};case 5:i.label++;r=s[1];s=[0];continue;case 7:s=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1];a=s;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(s);break}a[2]&&i.ops.pop();i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e];r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:true}}});var de=function(){function TorchController(e,t,n){this.isTorchOn=false;this.torchCapability=e;this.buttonController=t;this.onTorchActionFailureCallback=n}TorchController.prototype.isTorchEnabled=function(){return this.isTorchOn};TorchController.prototype.flipState=function(){return le(this,void 0,void 0,(function(){var e,t;return ue(this,(function(n){switch(n.label){case 0:this.buttonController.disable();e=!this.isTorchOn;n.label=1;case 1:n.trys.push([1,3,,4]);return[4,this.torchCapability.apply(e)];case 2:n.sent();this.updateUiBasedOnLatestSettings(this.torchCapability.value(),e);return[3,4];case 3:t=n.sent();this.propagateFailure(e,t);this.buttonController.enable();return[3,4];case 4:return[2]}}))}))};TorchController.prototype.updateUiBasedOnLatestSettings=function(e,t){if(e===t){this.buttonController.setText(t?p.torchOffButton():p.torchOnButton());this.isTorchOn=t}else this.propagateFailure(t);this.buttonController.enable()};TorchController.prototype.propagateFailure=function(e,t){var n=e?p.torchOnFailedMessage():p.torchOffFailedMessage();t&&(n+="; Error = "+t);this.onTorchActionFailureCallback(n)};TorchController.prototype.reset=function(){this.isTorchOn=false};return TorchController}();var he=function(){function TorchButton(e,t){this.onTorchActionFailureCallback=t;this.torchButton=ce.createElement("button",se.TORCH_BUTTON_ID);this.torchController=new de(e,this,t)}TorchButton.prototype.render=function(e,t){var n=this;this.torchButton.innerText=p.torchOnButton();this.torchButton.style.display=t.display;this.torchButton.style.marginLeft=t.marginLeft;var r=this;this.torchButton.addEventListener("click",(function(e){return le(n,void 0,void 0,(function(){return ue(this,(function(e){switch(e.label){case 0:return[4,r.torchController.flipState()];case 1:e.sent();if(r.torchController.isTorchEnabled()){r.torchButton.classList.remove(se.TORCH_BUTTON_CLASS_TORCH_OFF);r.torchButton.classList.add(se.TORCH_BUTTON_CLASS_TORCH_ON)}else{r.torchButton.classList.remove(se.TORCH_BUTTON_CLASS_TORCH_ON);r.torchButton.classList.add(se.TORCH_BUTTON_CLASS_TORCH_OFF)}return[2]}}))}))}));e.appendChild(this.torchButton)};TorchButton.prototype.updateTorchCapability=function(e){this.torchController=new de(e,this,this.onTorchActionFailureCallback)};TorchButton.prototype.getTorchButton=function(){return this.torchButton};TorchButton.prototype.hide=function(){this.torchButton.style.display="none"};TorchButton.prototype.show=function(){this.torchButton.style.display="inline-block"};TorchButton.prototype.disable=function(){this.torchButton.disabled=true};TorchButton.prototype.enable=function(){this.torchButton.disabled=false};TorchButton.prototype.setText=function(e){this.torchButton.innerText=e};TorchButton.prototype.reset=function(){this.torchButton.innerText=p.torchOnButton();this.torchController.reset()};TorchButton.create=function(e,t,n,r){var a=new TorchButton(t,r);a.render(e,n);return a};return TorchButton}();var pe=function(){function FileSelectionUi(e,t,n){this.fileBasedScanRegion=this.createFileBasedScanRegion();this.fileBasedScanRegion.style.display=t?"block":"none";e.appendChild(this.fileBasedScanRegion);var r=document.createElement("label");r.setAttribute("for",this.getFileScanInputId());r.style.display="inline-block";this.fileBasedScanRegion.appendChild(r);this.fileSelectionButton=ce.createElement("button",se.FILE_SELECTION_BUTTON_ID);this.setInitialValueToButton();this.fileSelectionButton.addEventListener("click",(function(e){r.click()}));r.append(this.fileSelectionButton);this.fileScanInput=ce.createElement("input",this.getFileScanInputId());this.fileScanInput.type="file";this.fileScanInput.accept="image/*";this.fileScanInput.style.display="none";r.appendChild(this.fileScanInput);var a=this;this.fileScanInput.addEventListener("change",(function(e){if(null!=e&&null!=e.target){var t=e.target;if(!t.files||0!==t.files.length){var r=t.files;var o=r[0];var i=o.name;a.setImageNameToButton(i);n(o)}}}));var o=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(o);this.fileBasedScanRegion.addEventListener("dragenter",(function(e){a.fileBasedScanRegion.style.border=a.fileBasedScanRegionActiveBorder();e.stopPropagation();e.preventDefault()}));this.fileBasedScanRegion.addEventListener("dragleave",(function(e){a.fileBasedScanRegion.style.border=a.fileBasedScanRegionDefaultBorder();e.stopPropagation();e.preventDefault()}));this.fileBasedScanRegion.addEventListener("dragover",(function(e){a.fileBasedScanRegion.style.border=a.fileBasedScanRegionActiveBorder();e.stopPropagation();e.preventDefault()}));this.fileBasedScanRegion.addEventListener("drop",(function(e){e.stopPropagation();e.preventDefault();a.fileBasedScanRegion.style.border=a.fileBasedScanRegionDefaultBorder();var t=e.dataTransfer;if(t){var r=t.files;if(!r||0===r.length)return;var i=false;for(var s=0;s<r.length;++s){var c=r.item(s);if(c){var l=/image.*/;if(c.type.match(l)){i=true;var u=c.name;a.setImageNameToButton(u);n(c);o.innerText=p.dragAndDropMessage();break}}}i||(o.innerText=p.dragAndDropMessageOnlyImages())}}))}FileSelectionUi.prototype.hide=function(){this.fileBasedScanRegion.style.display="none";this.fileScanInput.disabled=true};FileSelectionUi.prototype.show=function(){this.fileBasedScanRegion.style.display="block";this.fileScanInput.disabled=false};FileSelectionUi.prototype.isShowing=function(){return"block"===this.fileBasedScanRegion.style.display};FileSelectionUi.prototype.resetValue=function(){this.fileScanInput.value="";this.setInitialValueToButton()};FileSelectionUi.prototype.createFileBasedScanRegion=function(){var e=document.createElement("div");e.style.textAlign="center";e.style.margin="auto";e.style.width="80%";e.style.maxWidth="600px";e.style.border=this.fileBasedScanRegionDefaultBorder();e.style.padding="10px";e.style.marginBottom="10px";return e};FileSelectionUi.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"};FileSelectionUi.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"};FileSelectionUi.prototype.createDragAndDropMessage=function(){var e=document.createElement("div");e.innerText=p.dragAndDropMessage();e.style.fontWeight="400";return e};FileSelectionUi.prototype.setImageNameToButton=function(e){var t=20;if(e.length>t){var n=e.substring(0,8);var r=e.length;var a=e.substring(r-8,r);e="".concat(n,"....").concat(a)}var o=p.fileSelectionChooseAnother()+" - "+e;this.fileSelectionButton.innerText=o};FileSelectionUi.prototype.setInitialValueToButton=function(){var e=p.fileSelectionChooseImage()+" - "+p.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=e};FileSelectionUi.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"};FileSelectionUi.create=function(e,t,n){var r=new FileSelectionUi(e,t,n);return r};return FileSelectionUi}();var fe=function(){function CameraSelectionUi(e){this.selectElement=ce.createElement("select",se.CAMERA_SELECTION_SELECT_ID);this.cameras=e;this.options=[]}CameraSelectionUi.prototype.render=function(e){var t=document.createElement("span");t.style.marginRight="10px";var n=this.cameras.length;if(0===n)throw new Error("No cameras found");if(1===n)t.style.display="none";else{var r=p.selectCamera();t.innerText="".concat(r," (").concat(this.cameras.length,")  ")}var a=1;for(var o=0,i=this.cameras;o<i.length;o++){var s=i[o];var c=s.id;var l=null==s.label?c:s.label;l&&""!==l||(l=[p.anonymousCameraPrefix(),a++].join(" "));var u=document.createElement("option");u.value=c;u.innerText=l;this.options.push(u);this.selectElement.appendChild(u)}t.appendChild(this.selectElement);e.appendChild(t)};CameraSelectionUi.prototype.disable=function(){this.selectElement.disabled=true};CameraSelectionUi.prototype.isDisabled=function(){return true===this.selectElement.disabled};CameraSelectionUi.prototype.enable=function(){this.selectElement.disabled=false};CameraSelectionUi.prototype.getValue=function(){return this.selectElement.value};CameraSelectionUi.prototype.hasValue=function(e){for(var t=0,n=this.options;t<n.length;t++){var r=n[t];if(r.value===e)return true}return false};CameraSelectionUi.prototype.setValue=function(e){if(!this.hasValue(e))throw new Error("".concat(e," is not present in the camera list."));this.selectElement.value=e};CameraSelectionUi.prototype.hasSingleItem=function(){return 1===this.cameras.length};CameraSelectionUi.prototype.numCameras=function(){return this.cameras.length};CameraSelectionUi.create=function(e,t){var n=new CameraSelectionUi(t);n.render(e);return n};return CameraSelectionUi}();var ge=function(){function CameraZoomUi(){this.onChangeCallback=null;this.zoomElementContainer=document.createElement("div");this.rangeInput=ce.createElement("input",se.ZOOM_SLIDER_ID);this.rangeInput.type="range";this.rangeText=document.createElement("span");this.rangeInput.min="1";this.rangeInput.max="5";this.rangeInput.value="1";this.rangeInput.step="0.1"}CameraZoomUi.prototype.render=function(e,t){this.zoomElementContainer.style.display=t?"block":"none";this.zoomElementContainer.style.padding="5px 10px";this.zoomElementContainer.style.textAlign="center";e.appendChild(this.zoomElementContainer);this.rangeInput.style.display="inline-block";this.rangeInput.style.width="50%";this.rangeInput.style.height="5px";this.rangeInput.style.background="#d3d3d3";this.rangeInput.style.outline="none";this.rangeInput.style.opacity="0.7";var n=p.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(n);this.rangeText.style.marginRight="10px";var r=this;this.rangeInput.addEventListener("input",(function(){return r.onValueChange()}));this.rangeInput.addEventListener("change",(function(){return r.onValueChange()}));this.zoomElementContainer.appendChild(this.rangeInput);this.zoomElementContainer.appendChild(this.rangeText)};CameraZoomUi.prototype.onValueChange=function(){var e=p.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(e);this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))};CameraZoomUi.prototype.setValues=function(e,t,n,r){this.rangeInput.min=e.toString();this.rangeInput.max=t.toString();this.rangeInput.step=r.toString();this.rangeInput.value=n.toString();this.onValueChange()};CameraZoomUi.prototype.show=function(){this.zoomElementContainer.style.display="block"};CameraZoomUi.prototype.hide=function(){this.zoomElementContainer.style.display="none"};CameraZoomUi.prototype.setOnCameraZoomValueChangeCallback=function(e){this.onChangeCallback=e};CameraZoomUi.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null};CameraZoomUi.create=function(e,t){var n=new CameraZoomUi;n.render(e,t);return n};return CameraZoomUi}();var me;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT";e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS";e[e.STATUS_WARNING=2]="STATUS_WARNING";e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(me||(me={}));function toHtml5QrcodeCameraScanConfig(e){return{fps:e.fps,qrbox:e.qrbox,aspectRatio:e.aspectRatio,disableFlip:e.disableFlip,videoConstraints:e.videoConstraints}}function toHtml5QrcodeFullConfig(e,t){return{formatsToSupport:e.formatsToSupport,useBarCodeDetectorIfSupported:e.useBarCodeDetectorIfSupported,experimentalFeatures:e.experimentalFeatures,verbose:t}}var Se=function(){function Html5QrcodeScanner(e,t,n){this.lastMatchFound=null;this.cameraScanImage=null;this.fileScanImage=null;this.fileSelectionUi=null;this.elementId=e;this.config=this.createConfig(t);this.verbose=true===n;if(!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.scanTypeSelector=new ie(this.config.supportedScanTypes);this.currentScanType=this.scanTypeSelector.getDefaultScanType();this.sectionSwapAllowed=true;this.logger=new d(this.verbose);this.persistedDataManager=new $;true!==t.rememberLastUsedCamera&&this.persistedDataManager.reset()}Html5QrcodeScanner.prototype.render=function(e,t){var n=this;this.lastMatchFound=null;this.qrCodeSuccessCallback=function(t,r){if(e)e(t,r);else{if(n.lastMatchFound===t)return;n.lastMatchFound=t;n.setHeaderMessage(p.lastMatch(t),me.STATUS_SUCCESS)}};this.qrCodeErrorCallback=function(e,n){t&&t(e,n)};var r=document.getElementById(this.elementId);if(!r)throw"HTML Element with id=".concat(this.elementId," not found");r.innerHTML="";this.createBasicLayout(r);this.html5Qrcode=new Z(this.getScanRegionId(),toHtml5QrcodeFullConfig(this.config,this.verbose))};Html5QrcodeScanner.prototype.pause=function(e){(isNullOrUndefined(e)||true!==e)&&(e=false);this.getHtml5QrcodeOrFail().pause(e)};Html5QrcodeScanner.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()};Html5QrcodeScanner.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()};Html5QrcodeScanner.prototype.clear=function(){var e=this;var emptyHtmlContainer=function(){var t=document.getElementById(e.elementId);if(t){t.innerHTML="";e.resetBasicLayout(t)}};return this.html5Qrcode?new Promise((function(t,n){if(e.html5Qrcode)if(e.html5Qrcode.isScanning)e.html5Qrcode.stop().then((function(n){if(e.html5Qrcode){e.html5Qrcode.clear();emptyHtmlContainer();t()}else t()})).catch((function(t){e.verbose&&e.logger.logError("Unable to stop qrcode scanner",t);n(t)}));else{e.html5Qrcode.clear();emptyHtmlContainer();t()}else t()})):Promise.resolve()};Html5QrcodeScanner.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()};Html5QrcodeScanner.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()};Html5QrcodeScanner.prototype.applyVideoConstraints=function(e){return this.getHtml5QrcodeOrFail().applyVideoConstraints(e)};Html5QrcodeScanner.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode};Html5QrcodeScanner.prototype.createConfig=function(e){if(e){e.fps||(e.fps=i.SCAN_DEFAULT_FPS);e.rememberLastUsedCamera!==!i.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(e.rememberLastUsedCamera=i.DEFAULT_REMEMBER_LAST_CAMERA_USED);e.supportedScanTypes||(e.supportedScanTypes=i.DEFAULT_SUPPORTED_SCAN_TYPE);return e}return{fps:i.SCAN_DEFAULT_FPS,rememberLastUsedCamera:i.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:i.DEFAULT_SUPPORTED_SCAN_TYPE}};Html5QrcodeScanner.prototype.createBasicLayout=function(e){e.style.position="relative";e.style.padding="0px";e.style.border="1px solid silver";this.createHeader(e);var t=document.createElement("div");var n=this.getScanRegionId();t.id=n;t.style.width="100%";t.style.minHeight="100px";t.style.textAlign="center";e.appendChild(t);ie.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var r=document.createElement("div");var a=this.getDashboardId();r.id=a;r.style.width="100%";e.appendChild(r);this.setupInitialDashboard(r)};Html5QrcodeScanner.prototype.resetBasicLayout=function(e){e.style.border="none"};Html5QrcodeScanner.prototype.setupInitialDashboard=function(e){this.createSection(e);this.createSectionControlPanel();this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()};Html5QrcodeScanner.prototype.createHeader=function(e){var t=document.createElement("div");t.style.textAlign="left";t.style.margin="0px";e.appendChild(t);var n=new ne;n.renderInto(t);var r=document.createElement("div");r.id=this.getHeaderMessageContainerId();r.style.display="none";r.style.textAlign="center";r.style.fontSize="14px";r.style.padding="2px 10px";r.style.margin="4px";r.style.borderTop="1px solid #f6f6f6";t.appendChild(r)};Html5QrcodeScanner.prototype.createSection=function(e){var t=document.createElement("div");t.id=this.getDashboardSectionId();t.style.width="100%";t.style.padding="10px 0px 10px 0px";t.style.textAlign="left";e.appendChild(t)};Html5QrcodeScanner.prototype.createCameraListUi=function(e,t,n){var r=this;r.showHideScanTypeSwapLink(false);r.setHeaderMessage(p.cameraPermissionRequesting());var createPermissionButtonIfNotExists=function(){n||r.createPermissionButton(e,t)};Z.getCameras().then((function(n){r.persistedDataManager.setHasPermission(true);r.showHideScanTypeSwapLink(true);r.resetHeaderMessage();if(n&&n.length>0){e.removeChild(t);r.renderCameraSelection(n)}else{r.setHeaderMessage(p.noCameraFound(),me.STATUS_WARNING);createPermissionButtonIfNotExists()}})).catch((function(e){r.persistedDataManager.setHasPermission(false);n?n.disabled=false:createPermissionButtonIfNotExists();r.setHeaderMessage(e,me.STATUS_WARNING);r.showHideScanTypeSwapLink(true)}))};Html5QrcodeScanner.prototype.createPermissionButton=function(e,t){var n=this;var r=ce.createElement("button",this.getCameraPermissionButtonId());r.innerText=p.cameraPermissionTitle();r.addEventListener("click",(function(){r.disabled=true;n.createCameraListUi(e,t,r)}));t.appendChild(r)};Html5QrcodeScanner.prototype.createPermissionsUi=function(e,t){var n=this;ie.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()?oe.hasPermissions().then((function(r){if(r)n.createCameraListUi(e,t);else{n.persistedDataManager.setHasPermission(false);n.createPermissionButton(e,t)}})).catch((function(r){n.persistedDataManager.setHasPermission(false);n.createPermissionButton(e,t)})):this.createPermissionButton(e,t)};Html5QrcodeScanner.prototype.createSectionControlPanel=function(){var e=document.getElementById(this.getDashboardSectionId());var t=document.createElement("div");e.appendChild(t);var n=document.createElement("div");n.id=this.getDashboardSectionCameraScanRegionId();n.style.display=ie.isCameraScanType(this.currentScanType)?"block":"none";t.appendChild(n);var r=document.createElement("div");r.style.textAlign="center";n.appendChild(r);this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(n,r);this.renderFileScanUi(t)};Html5QrcodeScanner.prototype.renderFileScanUi=function(e){var t=ie.isFileScanType(this.currentScanType);var n=this;var onFileSelected=function(e){if(!n.html5Qrcode)throw"html5Qrcode not defined";if(ie.isFileScanType(n.currentScanType)){n.setHeaderMessage(p.loadingImage());n.html5Qrcode.scanFileV2(e,true).then((function(e){n.resetHeaderMessage();n.qrCodeSuccessCallback(e.decodedText,e)})).catch((function(e){n.setHeaderMessage(e,me.STATUS_WARNING);n.qrCodeErrorCallback(e,u.createFrom(e))}))}};this.fileSelectionUi=pe.create(e,t,onFileSelected)};Html5QrcodeScanner.prototype.renderCameraSelection=function(e){var t=this;var n=this;var r=document.getElementById(this.getDashboardSectionCameraScanRegionId());r.style.textAlign="center";var a=ge.create(r,false);var renderCameraZoomUiIfSupported=function(e){var n=e.zoomFeature();if(n.isSupported()){a.setOnCameraZoomValueChangeCallback((function(e){n.apply(e)}));var r=1;t.config.defaultZoomValueIfSupported&&(r=t.config.defaultZoomValueIfSupported);r=clip(r,n.min(),n.max());a.setValues(n.min(),n.max(),r,n.step());a.show()}};var o=fe.create(r,e);var i=document.createElement("span");var s=ce.createElement("button",se.CAMERA_START_BUTTON_ID);s.innerText=p.scanButtonStartScanningText();i.appendChild(s);var c=ce.createElement("button",se.CAMERA_STOP_BUTTON_ID);c.innerText=p.scanButtonStopScanningText();c.style.display="none";c.disabled=true;i.appendChild(c);var l;var createAndShowTorchButtonIfSupported=function(e){if(e.torchFeature().isSupported()){l?l.updateTorchCapability(e.torchFeature()):l=he.create(i,e.torchFeature(),{display:"none",marginLeft:"5px"},(function(e){n.setHeaderMessage(e,me.STATUS_WARNING)}));l.show()}else l&&l.hide()};r.appendChild(i);var resetCameraActionStartButton=function(e){e||(s.style.display="none");s.innerText=p.scanButtonStartScanningText();s.style.opacity="1";s.disabled=false;e&&(s.style.display="inline-block")};s.addEventListener("click",(function(e){s.innerText=p.scanButtonScanningStarting();o.disable();s.disabled=true;s.style.opacity="0.5";t.scanTypeSelector.hasMoreThanOneScanType()&&n.showHideScanTypeSwapLink(false);n.resetHeaderMessage();var r=o.getValue();n.persistedDataManager.setLastUsedCameraId(r);n.html5Qrcode.start(r,toHtml5QrcodeCameraScanConfig(n.config),n.qrCodeSuccessCallback,n.qrCodeErrorCallback).then((function(e){c.disabled=false;c.style.display="inline-block";resetCameraActionStartButton(false);var r=n.html5Qrcode.getRunningTrackCameraCapabilities();true===t.config.showTorchButtonIfSupported&&createAndShowTorchButtonIfSupported(r);true===t.config.showZoomSliderIfSupported&&renderCameraZoomUiIfSupported(r)})).catch((function(e){n.showHideScanTypeSwapLink(true);o.enable();resetCameraActionStartButton(true);n.setHeaderMessage(e,me.STATUS_WARNING)}))}));o.hasSingleItem()&&s.click();c.addEventListener("click",(function(e){if(!n.html5Qrcode)throw"html5Qrcode not defined";c.disabled=true;n.html5Qrcode.stop().then((function(e){t.scanTypeSelector.hasMoreThanOneScanType()&&n.showHideScanTypeSwapLink(true);o.enable();s.disabled=false;c.style.display="none";s.style.display="inline-block";if(l){l.reset();l.hide()}a.removeOnCameraZoomValueChangeCallback();a.hide();n.insertCameraScanImageToScanRegion()})).catch((function(e){c.disabled=false;n.setHeaderMessage(e,me.STATUS_WARNING)}))}));if(n.persistedDataManager.getLastUsedCameraId()){var u=n.persistedDataManager.getLastUsedCameraId();if(o.hasValue(u)){o.setValue(u);s.click()}else n.persistedDataManager.resetLastUsedCameraId()}};Html5QrcodeScanner.prototype.createSectionSwap=function(){var e=this;var t=p.textIfCameraScanSelected();var n=p.textIfFileScanSelected();var r=document.getElementById(this.getDashboardSectionId());var a=document.createElement("div");a.style.textAlign="center";var i=ce.createElement("span",this.getDashboardSectionSwapLinkId());i.style.textDecoration="underline";i.style.cursor="pointer";i.innerText=ie.isCameraScanType(this.currentScanType)?t:n;i.addEventListener("click",(function(){if(e.sectionSwapAllowed){e.resetHeaderMessage();e.fileSelectionUi.resetValue();e.sectionSwapAllowed=false;if(ie.isCameraScanType(e.currentScanType)){e.clearScanRegion();e.getCameraScanRegion().style.display="none";e.fileSelectionUi.show();i.innerText=n;e.currentScanType=o.SCAN_TYPE_FILE;e.insertFileScanImageToScanRegion()}else{e.clearScanRegion();e.getCameraScanRegion().style.display="block";e.fileSelectionUi.hide();i.innerText=t;e.currentScanType=o.SCAN_TYPE_CAMERA;e.insertCameraScanImageToScanRegion();e.startCameraScanIfPermissionExistsOnSwap()}e.sectionSwapAllowed=true}else e.verbose&&e.logger.logError("Section swap called when not allowed")}));a.appendChild(i);r.appendChild(a)};Html5QrcodeScanner.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var e=this;var t=this;this.persistedDataManager.hasCameraPermissions()&&oe.hasPermissions().then((function(n){if(n){var r=document.getElementById(t.getCameraPermissionButtonId());if(!r){e.logger.logError("Permission button not found, fail;");throw"Permission button not found"}r.click()}else t.persistedDataManager.setHasPermission(false)})).catch((function(e){t.persistedDataManager.setHasPermission(false)}))};Html5QrcodeScanner.prototype.resetHeaderMessage=function(){var e=document.getElementById(this.getHeaderMessageContainerId());e.style.display="none"};Html5QrcodeScanner.prototype.setHeaderMessage=function(e,t){t||(t=me.STATUS_DEFAULT);var n=this.getHeaderMessageDiv();n.innerText=e;n.style.display="block";switch(t){case me.STATUS_SUCCESS:n.style.background="rgba(106, 175, 80, 0.26)";n.style.color="#477735";break;case me.STATUS_WARNING:n.style.background="rgba(203, 36, 49, 0.14)";n.style.color="#cb2431";break;case me.STATUS_DEFAULT:default:n.style.background="rgba(0, 0, 0, 0)";n.style.color="rgb(17, 17, 17)";break}};Html5QrcodeScanner.prototype.showHideScanTypeSwapLink=function(e){if(this.scanTypeSelector.hasMoreThanOneScanType()){true!==e&&(e=false);this.sectionSwapAllowed=e;this.getDashboardSectionSwapLink().style.display=e?"inline-block":"none"}};Html5QrcodeScanner.prototype.insertCameraScanImageToScanRegion=function(){var e=this;var t=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){t.innerHTML="<br>";t.appendChild(this.cameraScanImage)}else{this.cameraScanImage=new Image;this.cameraScanImage.onload=function(n){t.innerHTML="<br>";t.appendChild(e.cameraScanImage)};this.cameraScanImage.width=64;this.cameraScanImage.style.opacity="0.8";this.cameraScanImage.src=W;this.cameraScanImage.alt=p.cameraScanAltText()}};Html5QrcodeScanner.prototype.insertFileScanImageToScanRegion=function(){var e=this;var t=document.getElementById(this.getScanRegionId());if(this.fileScanImage){t.innerHTML="<br>";t.appendChild(this.fileScanImage)}else{this.fileScanImage=new Image;this.fileScanImage.onload=function(n){t.innerHTML="<br>";t.appendChild(e.fileScanImage)};this.fileScanImage.width=64;this.fileScanImage.style.opacity="0.8";this.fileScanImage.src=G;this.fileScanImage.alt=p.fileScanAltText()}};Html5QrcodeScanner.prototype.clearScanRegion=function(){var e=document.getElementById(this.getScanRegionId());e.innerHTML=""};Html5QrcodeScanner.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")};Html5QrcodeScanner.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")};Html5QrcodeScanner.prototype.getDashboardSectionSwapLinkId=function(){return se.SCAN_TYPE_CHANGE_ANCHOR_ID};Html5QrcodeScanner.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")};Html5QrcodeScanner.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")};Html5QrcodeScanner.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")};Html5QrcodeScanner.prototype.getCameraPermissionButtonId=function(){return se.CAMERA_PERMISSION_BUTTON_ID};Html5QrcodeScanner.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())};Html5QrcodeScanner.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())};Html5QrcodeScanner.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())};return Html5QrcodeScanner}();export{Z as Html5Qrcode,o as Html5QrcodeScanType,Se as Html5QrcodeScanner,F as Html5QrcodeScannerState,n as Html5QrcodeSupportedFormats};

